#!perl
use v5.24.0;
use warnings;

use lib 'lib';

use IO::Async::Loop;
use Synergy::Hub;

my $key = qx(cat ~/.jem.key);
chomp $key;

my $synergy = Synergy::Hub->synergize({
  ($ENV{SYNERGY_USERS_FILE}
    ? (user_directory => $ENV{SYNERGY_USERS_FILE})
    : ()),
  channels => {
    'slack-fm' => {
      class   => 'Synergy::Channel::Slack',
      api_key => $key,
    },
  },
  reactors => {
    clox    => { class => 'Synergy::Reactor::Clox' },
    echo    => { class => 'Synergy::Reactor::Echo' },
    lp      => { class => 'Synergy::Reactor::LiquidPlanner' },
    slackid => { class => 'Synergy::Reactor::SlackID' },
    announce=> {
      class => 'Synergy::Reactor::Announce',
      slack_channel_name => 'slack-fm',
      announce_chan_name => 'bottest',
    }
  },
});

$synergy->loop->run;
